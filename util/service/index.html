<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="AVWX Engine Package Documentation"><meta name=author content="Michael duPont"><link href=https://engine.avwx.rest/util/service/ rel=canonical><link href=../station/ rel=prev><link href=../data/ rel=next><link rel=icon href=../../assets/images/favicon.ico><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.4.2"><title>Data Services - AVWX Engine</title><link rel=stylesheet href=../../assets/stylesheets/main.d451bc0e.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.a5377069.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=../../assets/stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#report-source-services class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=https://avwx.rest title="AVWX Engine" class="md-header__button md-logo" aria-label="AVWX Engine" data-md-component=logo> <img src=../../assets/images/avwx-icon-32-white.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> AVWX Engine </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Data Services </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/avwx-rest/avwx-engine title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://avwx.rest title="AVWX Engine" class="md-nav__button md-logo" aria-label="AVWX Engine" data-md-component=logo> <img src=../../assets/images/avwx-icon-32-white.png alt=logo> </a> AVWX Engine </label> <div class=md-nav__source> <a href=https://github.com/avwx-rest/avwx-engine title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../getting-started/ class=md-nav__link> <span class=md-ellipsis> Getting Started </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Aviation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Aviation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../av/metar/ class=md-nav__link> <span class=md-ellipsis> METAR </span> </a> </li> <li class=md-nav__item> <a href=../../av/taf/ class=md-nav__link> <span class=md-ellipsis> TAF </span> </a> </li> <li class=md-nav__item> <a href=../../av/pirep/ class=md-nav__link> <span class=md-ellipsis> PIREP </span> </a> </li> <li class=md-nav__item> <a href=../../av/airsigmet/ class=md-nav__link> <span class=md-ellipsis> AIRMET / SIGMET </span> </a> </li> <li class=md-nav__item> <a href=../../av/notam/ class=md-nav__link> <span class=md-ellipsis> NOTAM </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Models </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Models </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../nbm/nbh/ class=md-nav__link> <span class=md-ellipsis> NBM NBH </span> </a> </li> <li class=md-nav__item> <a href=../../nbm/nbs/ class=md-nav__link> <span class=md-ellipsis> NBM NBS </span> </a> </li> <li class=md-nav__item> <a href=../../nbm/nbe/ class=md-nav__link> <span class=md-ellipsis> NBM NBE </span> </a> </li> <li class=md-nav__item> <a href=../../gfs/mav/ class=md-nav__link> <span class=md-ellipsis> GFS MOS MAV </span> </a> </li> <li class=md-nav__item> <a href=../../gfs/mex/ class=md-nav__link> <span class=md-ellipsis> GFS MOS MEX </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Utilities </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Utilities </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../station/ class=md-nav__link> <span class=md-ellipsis> Station </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Data Services </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Data Services </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#basic-module-use class=md-nav__link> Basic Module Use </a> <nav class=md-nav aria-label="Basic Module Use"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#avwxserviceget_servicestation-str-country-str-avwxserviceservice class=md-nav__link> avwx.service.get_service(station: str, country: str) -&gt; avwx.service.Service </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#base-service-class class=md-nav__link> Base Service Class </a> <nav class=md-nav aria-label="Base Service Class"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#class-avwxserviceservicereport_type-str class=md-nav__link> class avwx.service.Service(report_type: str) </a> <nav class=md-nav aria-label="class avwx.service.Service(report_type: str)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#fetchstation-str-timeout-int-10-str class=md-nav__link> fetch(station: str, timeout: int = 10) -&gt; str </a> </li> <li class=md-nav__item> <a href=#async-async_fetchstation-str-timeout-int-10-str class=md-nav__link> async async_fetch(station: str, timeout: int = 10) -&gt; str </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#web-scrape-services class=md-nav__link> Web Scrape Services </a> <nav class=md-nav aria-label="Web Scrape Services"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#classservicescrapescrapeservicereport_type-str class=md-nav__link> class.service.scrape.ScrapeService(report_type: str) </a> </li> <li class=md-nav__item> <a href=#class-avwxservicenoaareport_type-str class=md-nav__link> class avwx.service.NOAA(report_type: str) </a> </li> <li class=md-nav__item> <a href=#class-avwxservicenoaa_addsreport_type-str class=md-nav__link> class avwx.service.NOAA_ADDS(report_type: str) </a> </li> <li class=md-nav__item> <a href=#avwxserviceamoreport_type-str class=md-nav__link> avwx.service.AMO(report_type: str) </a> </li> <li class=md-nav__item> <a href=#avwxservicemacreport_type-str class=md-nav__link> avwx.service.MAC(report_type: str) </a> </li> <li class=md-nav__item> <a href=#avwxserviceaubomreport_type-str class=md-nav__link> avwx.service.AUBOM(report_type: str) </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#file-services class=md-nav__link> File Services </a> <nav class=md-nav aria-label="File Services"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#avwxservicefilesfileservicereport_type class=md-nav__link> avwx.service.files.FileService(report_type) </a> <nav class=md-nav aria-label=avwx.service.files.FileService(report_type)> <ul class=md-nav__list> <li class=md-nav__item> <a href=#all-liststr class=md-nav__link> all: List[str] </a> </li> <li class=md-nav__item> <a href=#is_outdated-bool class=md-nav__link> is_outdated: bool </a> </li> <li class=md-nav__item> <a href=#last_updated-optionaldatetimedatetime class=md-nav__link> last_updated: Optional[datetime.datetime] </a> </li> <li class=md-nav__item> <a href=#update_interval-datetimetimedelta-datetimetimedeltaminutes10 class=md-nav__link> update_interval: datetime.timedelta = datetime.timedelta(minutes=10) </a> </li> <li class=md-nav__item> <a href=#async-updatewait-bool-false-timeout-int-10-bool class=md-nav__link> async update(wait: bool = False, timeout: int = 10) -&gt; bool </a> </li> <li class=md-nav__item> <a href=#fetchstation-str-wait-bool-true-timeout-int-10-force-bool-false-optionalstr class=md-nav__link> fetch(station: str, wait: bool = True, timeout: int = 10, force: bool = False) -&gt; Optional[str] </a> </li> <li class=md-nav__item> <a href=#async-async_fetchstation-str-wait-bool-true-timeout-int-10-force-bool-false-optionalstr class=md-nav__link> async async_fetch(station: str, wait: bool = True, timeout: int = 10, force: bool = False) -&gt; Optional[str] </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#avwxservicenoaa_nbmreport_type class=md-nav__link> avwx.service.NOAA_NBM(report_type) </a> </li> <li class=md-nav__item> <a href=#avwxservicenoaa_gfsreport_type class=md-nav__link> avwx.service.NOAA_GFS(report_type) </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bulk-services class=md-nav__link> Bulk Services </a> <nav class=md-nav aria-label="Bulk Services"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#avwxservicebulknoaa_bulkreport_type class=md-nav__link> avwx.service.bulk.NOAA_Bulk(report_type) </a> </li> <li class=md-nav__item> <a href=#avwxservicebulknoaa_intlreport_type class=md-nav__link> avwx.service.bulk.NOAA_Intl(report_type) </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#adding-a-new-service class=md-nav__link> Adding a New Service </a> <nav class=md-nav aria-label="Adding a New Service"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#scrapeservice class=md-nav__link> ScrapeService </a> </li> <li class=md-nav__item> <a href=#fileservice class=md-nav__link> FileService </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../data/ class=md-nav__link> <span class=md-ellipsis> Data Updates </span> </a> </li> <li class=md-nav__item> <a href=../structs/ class=md-nav__link> <span class=md-ellipsis> Data Structures </span> </a> </li> <li class=md-nav__item> <a href=../static/ class=md-nav__link> <span class=md-ellipsis> Static Values </span> </a> </li> <li class=md-nav__item> <a href=../exceptions/ class=md-nav__link> <span class=md-ellipsis> Exceptions </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#basic-module-use class=md-nav__link> Basic Module Use </a> <nav class=md-nav aria-label="Basic Module Use"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#avwxserviceget_servicestation-str-country-str-avwxserviceservice class=md-nav__link> avwx.service.get_service(station: str, country: str) -&gt; avwx.service.Service </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#base-service-class class=md-nav__link> Base Service Class </a> <nav class=md-nav aria-label="Base Service Class"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#class-avwxserviceservicereport_type-str class=md-nav__link> class avwx.service.Service(report_type: str) </a> <nav class=md-nav aria-label="class avwx.service.Service(report_type: str)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#fetchstation-str-timeout-int-10-str class=md-nav__link> fetch(station: str, timeout: int = 10) -&gt; str </a> </li> <li class=md-nav__item> <a href=#async-async_fetchstation-str-timeout-int-10-str class=md-nav__link> async async_fetch(station: str, timeout: int = 10) -&gt; str </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#web-scrape-services class=md-nav__link> Web Scrape Services </a> <nav class=md-nav aria-label="Web Scrape Services"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#classservicescrapescrapeservicereport_type-str class=md-nav__link> class.service.scrape.ScrapeService(report_type: str) </a> </li> <li class=md-nav__item> <a href=#class-avwxservicenoaareport_type-str class=md-nav__link> class avwx.service.NOAA(report_type: str) </a> </li> <li class=md-nav__item> <a href=#class-avwxservicenoaa_addsreport_type-str class=md-nav__link> class avwx.service.NOAA_ADDS(report_type: str) </a> </li> <li class=md-nav__item> <a href=#avwxserviceamoreport_type-str class=md-nav__link> avwx.service.AMO(report_type: str) </a> </li> <li class=md-nav__item> <a href=#avwxservicemacreport_type-str class=md-nav__link> avwx.service.MAC(report_type: str) </a> </li> <li class=md-nav__item> <a href=#avwxserviceaubomreport_type-str class=md-nav__link> avwx.service.AUBOM(report_type: str) </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#file-services class=md-nav__link> File Services </a> <nav class=md-nav aria-label="File Services"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#avwxservicefilesfileservicereport_type class=md-nav__link> avwx.service.files.FileService(report_type) </a> <nav class=md-nav aria-label=avwx.service.files.FileService(report_type)> <ul class=md-nav__list> <li class=md-nav__item> <a href=#all-liststr class=md-nav__link> all: List[str] </a> </li> <li class=md-nav__item> <a href=#is_outdated-bool class=md-nav__link> is_outdated: bool </a> </li> <li class=md-nav__item> <a href=#last_updated-optionaldatetimedatetime class=md-nav__link> last_updated: Optional[datetime.datetime] </a> </li> <li class=md-nav__item> <a href=#update_interval-datetimetimedelta-datetimetimedeltaminutes10 class=md-nav__link> update_interval: datetime.timedelta = datetime.timedelta(minutes=10) </a> </li> <li class=md-nav__item> <a href=#async-updatewait-bool-false-timeout-int-10-bool class=md-nav__link> async update(wait: bool = False, timeout: int = 10) -&gt; bool </a> </li> <li class=md-nav__item> <a href=#fetchstation-str-wait-bool-true-timeout-int-10-force-bool-false-optionalstr class=md-nav__link> fetch(station: str, wait: bool = True, timeout: int = 10, force: bool = False) -&gt; Optional[str] </a> </li> <li class=md-nav__item> <a href=#async-async_fetchstation-str-wait-bool-true-timeout-int-10-force-bool-false-optionalstr class=md-nav__link> async async_fetch(station: str, wait: bool = True, timeout: int = 10, force: bool = False) -&gt; Optional[str] </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#avwxservicenoaa_nbmreport_type class=md-nav__link> avwx.service.NOAA_NBM(report_type) </a> </li> <li class=md-nav__item> <a href=#avwxservicenoaa_gfsreport_type class=md-nav__link> avwx.service.NOAA_GFS(report_type) </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bulk-services class=md-nav__link> Bulk Services </a> <nav class=md-nav aria-label="Bulk Services"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#avwxservicebulknoaa_bulkreport_type class=md-nav__link> avwx.service.bulk.NOAA_Bulk(report_type) </a> </li> <li class=md-nav__item> <a href=#avwxservicebulknoaa_intlreport_type class=md-nav__link> avwx.service.bulk.NOAA_Intl(report_type) </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#adding-a-new-service class=md-nav__link> Adding a New Service </a> <nav class=md-nav aria-label="Adding a New Service"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#scrapeservice class=md-nav__link> ScrapeService </a> </li> <li class=md-nav__item> <a href=#fileservice class=md-nav__link> FileService </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=report-source-services>Report Source Services</h1> <p>AVWX fetches the raw weather reports from third-party services via REST API calls or file downloads. We use Service objects to handle the request and extraction for us.</p> <h2 id=basic-module-use>Basic Module Use</h2> <p>METARs and TAFs are the most widely-supported report types, so an effort has been made to localize some of these services to a regional source. The <code>get_service</code> function was introduced to determine the best service for a given station.</p> <h3 id=avwxserviceget_servicestation-str-country-str-avwxserviceservice>avwx.service.<strong>get_service</strong>(<em>station: str, country: str</em>) -&gt; <em>avwx.service.Service</em></h3> <p>Returns the preferred scrape service for a given station</p> <div class=highlight><pre><span></span><code><span class=c1># Fetch Australian reports</span>
<span class=n>station</span> <span class=o>=</span> <span class=s1>&#39;YWOL&#39;</span>
<span class=n>country</span> <span class=o>=</span> <span class=s1>&#39;AU&#39;</span> <span class=c1># can source from avwx.Station.country</span>
<span class=c1># Get the station&#39;s preferred service and initialize to fetch METARs</span>
<span class=n>service</span> <span class=o>=</span> <span class=n>avwx</span><span class=o>.</span><span class=n>service</span><span class=o>.</span><span class=n>get_service</span><span class=p>(</span><span class=n>station</span><span class=p>,</span> <span class=n>country</span><span class=p>)(</span><span class=s1>&#39;metar&#39;</span><span class=p>)</span>
<span class=c1># service is now avwx.service.AUBOM init&#39;d to fetch METARs</span>
<span class=c1># Fetch the current METAR</span>
<span class=n>report</span> <span class=o>=</span> <span class=n>service</span><span class=o>.</span><span class=n>fetch</span><span class=p>(</span><span class=n>station</span><span class=p>)</span>
</code></pre></div> <p>Other report types require specific service classes which are detailed below.</p> <h2 id=base-service-class>Base Service Class</h2> <p>Both web scrape and file-based services are based off of the Service class and should all return the final report string with the fetch method.</p> <h3 id=class-avwxserviceservicereport_type-str>class avwx.service.<strong>Service</strong>(<em>report_type: str</em>)</h3> <p>Base Service class for fetching reports</p> <h4 id=fetchstation-str-timeout-int-10-str><strong>fetch</strong>(<em>station: str, timeout: int = 10</em>) -&gt; <em>str</em></h4> <p>Fetches a report string from the service</p> <h4 id=async-async_fetchstation-str-timeout-int-10-str>async <strong>async_fetch</strong>(<em>station: str, timeout: int = 10</em>) -&gt; <em>str</em></h4> <p>Asynchronously fetch a report string from the service</p> <h2 id=web-scrape-services>Web Scrape Services</h2> <p>These services request reports via HTML scraping or direct API requests. Requests are ephemeral and will call the selected service each time.</p> <h3 id=classservicescrapescrapeservicereport_type-str>class.service.scrape.<strong>ScrapeService</strong>(<em>report_type: str</em>)</h3> <p>Service class for fetching reports via direct web requests</p> <p>Unless overwritten, this class accepts <code>"metar"</code> and <code>"taf"</code> as valid report types</p> <h3 id=class-avwxservicenoaareport_type-str>class avwx.service.<strong>NOAA</strong>(<em>report_type: str</em>)</h3> <p>Requests data from NOAA</p> <h3 id=class-avwxservicenoaa_addsreport_type-str>class avwx.service.<strong>NOAA_ADDS</strong>(<em>report_type: str</em>)</h3> <p>Requests data from NOAA ADDS</p> <p>This class accepts <code>"metar"</code>, <code>"taf"</code>, and <code>"aircraftreport"</code> as valid report types. It will also accept <code>lat</code> and <code>lon</code> as fetch parameters in addition to <code>station</code>.</p> <h3 id=avwxserviceamoreport_type-str>avwx.service.<strong>AMO</strong>(<em>report_type: str</em>)</h3> <p>Requests data from AMO KMA for Korean stations</p> <h3 id=avwxservicemacreport_type-str>avwx.service.<strong>MAC</strong>(<em>report_type: str</em>)</h3> <p>Requests data from Meteorologia Aeronautica Civil for Columbian stations</p> <h3 id=avwxserviceaubomreport_type-str>avwx.service.<strong>AUBOM</strong>(<em>report_type: str</em>)</h3> <p>Requests data from the Australian Bureau of Meteorology</p> <h2 id=file-services>File Services</h2> <p>These services are directed at FTP servers to find the most recent file associated with the search criteria. Files are stored in a temporary directory which is deleted when the program ends. Fetch requests will extract reports from the downloaded file until an update interval has been exceeded, at which point the service will check for a newer file. You can also have direct access to all downloaded reports.</p> <h3 id=avwxservicefilesfileservicereport_type>avwx.service.files.FileService(<em>report_type</em>)</h3> <p>Service class for fetching reports via managed source files</p> <h4 id=all-liststr><strong>all</strong>: <em>List[str]</em></h4> <h4 id=is_outdated-bool><strong>is_outdated</strong>: <em>bool</em></h4> <h4 id=last_updated-optionaldatetimedatetime><strong>last_updated</strong>: <em>Optional[datetime.datetime]</em></h4> <h4 id=update_interval-datetimetimedelta-datetimetimedeltaminutes10><strong>update_interval</strong>: <em>datetime.timedelta = datetime.timedelta(minutes=10)</em></h4> <h4 id=async-updatewait-bool-false-timeout-int-10-bool>async <strong>update</strong>(<em>wait: bool = False, timeout: int = 10</em>) -&gt; <em>bool</em></h4> <p>Update the stored file and returns success</p> <p>If wait, this will block if the file is already being updated</p> <h4 id=fetchstation-str-wait-bool-true-timeout-int-10-force-bool-false-optionalstr><strong>fetch</strong>(<em>station: str, wait: bool = True, timeout: int = 10, force: bool = False</em>) -&gt; Optional[str]</h4> <p>Fetch a report string from the source file</p> <p>If wait, this will block if the file is already being updated</p> <p>Can force the service to fetch a new file</p> <h4 id=async-async_fetchstation-str-wait-bool-true-timeout-int-10-force-bool-false-optionalstr>async <strong>async_fetch</strong>(<em>station: str, wait: bool = True, timeout: int = 10, force: bool = False</em>) -&gt; Optional[str]</h4> <p>Asynchronously fetch a report string from the source file</p> <p>If wait, this will block if the file is already being updated</p> <p>Can force the service to fetch a new file</p> <h3 id=avwxservicenoaa_nbmreport_type>avwx.service.NOAA_NBM(<em>report_type</em>)</h3> <p>Requests forecast data from NOAA NBM FTP servers</p> <p>This class accepts <code>"nbh"</code>, <code>"nbs"</code>, and <code>"nbe"</code> as valid report types</p> <h3 id=avwxservicenoaa_gfsreport_type>avwx.service.NOAA_GFS(<em>report_type</em>)</h3> <p>Requests forecast data from NOAA GFS FTP servers</p> <p>This class accepts <code>"mav"</code> and <code>"mex"</code> as valid report types</p> <h2 id=bulk-services>Bulk Services</h2> <p>These services are specifically for returning multiple reports at a time. For example, we'd want to know all SIGMETs currently in circulation. The sources can be FTP, scraping, or any other method. There is no need for specific stations or updating files behind the scenes.</p> <p>The <code>fetch</code> and <code>async_fetch</code> methods are identical except they return <code>List[str]</code> instead.</p> <h3 id=avwxservicebulknoaa_bulkreport_type>avwx.service.bulk.NOAA_Bulk(<em>report_type</em>)</h3> <p>Requests data from NOAA FTP file servers</p> <p>This class accepts <code>"metar"</code>, <code>"taf"</code>, <code>"aircraftreport"</code>, and <code>"airsigmet"</code> as valid report types.</p> <h3 id=avwxservicebulknoaa_intlreport_type>avwx.service.bulk.NOAA_Intl(<em>report_type</em>)</h3> <p>Scrapes international reports from NOAA. Designed to accompany <code>NOAA_Bulk</code> for AIRMET / SIGMET fetch.</p> <p>Currently, this class only accepts <code>"airsigmet"</code> as a valid report type.</p> <h2 id=adding-a-new-service>Adding a New Service</h2> <p>If the existing services are not supplying the report(s) you need, adding a new service is easy. First, you'll need to determine if your source can be scraped or you need to download a file.</p> <h3 id=scrapeservice>ScrapeService</h3> <p>For web scraping sources, you'll need to do the following things:</p> <ul> <li>Add the base URL and method (if not <code>"GET"</code>)</li> <li>Implement the <code>ScrapeService._make_url</code> to return the source URL and query parameters</li> <li>Implement the <code>ScrapeService._extract</code> function to return just the report string (starting at the station ID) from the response</li> </ul> <p>Let's look at the MAC service as an example:</p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>MAC</span><span class=p>(</span><span class=n>ScrapeService</span><span class=p>):</span>
<span class=sd>&quot;&quot;&quot;</span>
<span class=sd>Requests data from Meteorologia Aeronautica Civil for Columbian stations</span>
<span class=sd>&quot;&quot;&quot;</span>

<span class=n>url</span> <span class=o>=</span> <span class=s2>&quot;http://meteorologia.aerocivil.gov.co/expert_text_query/parse&quot;</span>
<span class=n>method</span> <span class=o>=</span> <span class=s2>&quot;POST&quot;</span>

<span class=k>def</span> <span class=nf>_make_url</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>station</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Returns a formatted URL and parameters</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>url</span><span class=p>,</span> <span class=p>{</span><span class=s2>&quot;query&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>rtype</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>station</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>}</span>

<span class=k>def</span> <span class=nf>_extract</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>raw</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>station</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Extracts the reports message using string finding</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>report</span> <span class=o>=</span> <span class=n>raw</span><span class=p>[</span><span class=n>raw</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>station</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span> <span class=o>+</span> <span class=s2>&quot; &quot;</span><span class=p>)</span> <span class=p>:]</span>
    <span class=n>report</span> <span class=o>=</span> <span class=n>report</span><span class=p>[:</span> <span class=n>report</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s2>&quot; =&quot;</span><span class=p>)]</span>
    <span class=k>return</span> <span class=n>report</span>
</code></pre></div> <p>Our URL and query parameters are returned using <code>_make_url</code> so <code>fetch</code> knows how to request the report. The result of this query is given to <code>_extract</code> which returns the report or list of reports.</p> <p>Once your service is created, it can optionally be added to <code>avwx.service.scrape.PREFERRED</code> if the service covers all stations with a known ICAO prefix or <code>avwx.service.scrape.BY_COUNTRY</code> if the service covers all stations in a single country. This is how <code>avwx.service.get_service</code> determines the preferred service. For example, the MAC service is preferred over NOAA for all ICAOs starting with "SK" while AUBOM is better for all Australian stations.</p> <h3 id=fileservice>FileService</h3> <p>For file-based sources, you'll need to do the following things:</p> <ul> <li>Add the base URL and valid report types</li> <li>Implement the <code>FileService._urls</code> to iterate through source URLs</li> <li>Implement the <code>FileService._extract</code> function to return just the report string (starting at the station ID) from the response</li> </ul> <p>Let's look at the NOAA_NBM service as an example:</p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>NOAA_NBM</span><span class=p>(</span><span class=n>FileService</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Requests forecast data from NOAA NBM FTP servers</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>url</span> <span class=o>=</span> <span class=s2>&quot;https://nomads.ncep.noaa.gov/pub/data/nccf/com/blend/prod/blend.</span><span class=si>{}</span><span class=s2>/</span><span class=si>{}</span><span class=s2>/text/blend_</span><span class=si>{}</span><span class=s2>tx.t</span><span class=si>{}</span><span class=s2>z&quot;</span>
    <span class=n>_valid_types</span> <span class=o>=</span> <span class=p>(</span><span class=s2>&quot;nbh&quot;</span><span class=p>,</span> <span class=s2>&quot;nbs&quot;</span><span class=p>,</span> <span class=s2>&quot;nbe&quot;</span><span class=p>)</span>

    <span class=nd>@property</span>
    <span class=k>def</span> <span class=nf>_urls</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Iterator</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Iterates through hourly updates no older than two days</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>date</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>(</span><span class=n>tz</span><span class=o>=</span><span class=n>dt</span><span class=o>.</span><span class=n>timezone</span><span class=o>.</span><span class=n>utc</span><span class=p>)</span>
        <span class=n>cutoff</span> <span class=o>=</span> <span class=n>date</span> <span class=o>-</span> <span class=n>dt</span><span class=o>.</span><span class=n>timedelta</span><span class=p>(</span><span class=n>days</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
        <span class=k>while</span> <span class=n>date</span> <span class=o>&gt;</span> <span class=n>cutoff</span><span class=p>:</span>
            <span class=n>timestamp</span> <span class=o>=</span> <span class=n>date</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=sa>r</span><span class=s2>&quot;%Y%m</span><span class=si>%d</span><span class=s2>&quot;</span><span class=p>)</span>
            <span class=n>hour</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>date</span><span class=o>.</span><span class=n>hour</span><span class=p>)</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
            <span class=k>yield</span> <span class=bp>self</span><span class=o>.</span><span class=n>url</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>timestamp</span><span class=p>,</span> <span class=n>hour</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>report_type</span><span class=p>,</span> <span class=n>hour</span><span class=p>)</span>
            <span class=n>date</span> <span class=o>-=</span> <span class=n>dt</span><span class=o>.</span><span class=n>timedelta</span><span class=p>(</span><span class=n>hours</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>

    <span class=k>def</span> <span class=nf>_extract</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>station</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>source</span><span class=p>:</span> <span class=n>TextIO</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Returns report pulled from the saved file</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>start</span> <span class=o>=</span> <span class=n>station</span> <span class=o>+</span> <span class=s2>&quot;   &quot;</span>
        <span class=n>end</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>report_type</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span> <span class=o>+</span> <span class=s2>&quot; GUIDANCE&quot;</span>
        <span class=n>txt</span> <span class=o>=</span> <span class=n>source</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
        <span class=n>txt</span> <span class=o>=</span> <span class=n>txt</span><span class=p>[</span><span class=n>txt</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>start</span><span class=p>)</span> <span class=p>:]</span>
        <span class=n>txt</span> <span class=o>=</span> <span class=n>txt</span><span class=p>[:</span> <span class=n>txt</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>end</span><span class=p>,</span> <span class=mi>30</span><span class=p>)]</span>
        <span class=n>lines</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>txt</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>):</span>
            <span class=k>if</span> <span class=s2>&quot;CLIMO&quot;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>line</span><span class=p>:</span>
                <span class=n>line</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>line</span><span class=p>:</span>
                <span class=k>break</span>
            <span class=n>lines</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
        <span class=k>return</span> <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>lines</span><span class=p>)</span> <span class=ow>or</span> <span class=kc>None</span>
</code></pre></div> <p>In this example, we iterate through <code>_urls</code> looking for the most recent published file. URL iterators should always have a lower bound to stop iteration so the service can return a null response.</p> <p>Once the file is downloaded, the requested station and file-like object are passed to the <code>_extract</code> method to find and return the report from the file. This method will not be called if the file doesn't exist.</p> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2022 duPont Technologies LLC </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.a264c092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.726fbb30.min.js></script> </body> </html>